<!DOCTYPE html>
<html lang="en"><head>
<script src="basic_stats_session3_files/libs/clipboard/clipboard.min.js"></script>
<script src="basic_stats_session3_files/libs/quarto-html/tabby.min.js"></script>
<script src="basic_stats_session3_files/libs/quarto-html/popper.min.js"></script>
<script src="basic_stats_session3_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="basic_stats_session3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="basic_stats_session3_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="basic_stats_session3_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="basic_stats_session3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="GÃ©raldine Derroire">
  <meta name="dcterms.date" content="2025-06-10">
  <title>Statistics with R - session 3 - Multivariate analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="basic_stats_session3_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="basic_stats_session3_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="basic_stats_session3_files/libs/revealjs/dist/theme/quarto.css">
  <link href="basic_stats_session3_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="basic_stats_session3_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="basic_stats_session3_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="basic_stats_session3_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="basic_stats_session3_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="basic_stats_session3_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistics with R - session 3 - Multivariate analysis</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
GÃ©raldine Derroire 
</div>
        <p class="quarto-title-affiliation">
            Cirad - UnB
          </p>
    </div>
</div>

  <p class="date">2025-06-10</p>
</section>
<section id="why-multivariate-analyses" class="slide level2">
<h2>Why multivariate analyses ?</h2>
<p><strong>Multivariate analysis</strong> are used to study the joint distribution of several variables, <em>i.e.</em> the variation of each variable and their correlations.</p>
<ul>
<li class="fragment"><p><strong>Clustering methods</strong> aim to group observations based on similarities across multiple variables.</p></li>
<li class="fragment"><p><strong>Ordination methods</strong> aim to rearrange the observations in a lower-dimensional space to reduce the dimensionality of the data while preserving the main patterns of variation.</p></li>
</ul>
<aside class="notes">
<p>last session, when more than 2 variables, there was just one univariate response variable, so different</p>
<p>explain the reduction of dimensionality</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="why-multivariate-analyses-1" class="slide level2">
<h2>Why multivariate analyses ?</h2>
<p><strong>Ordination methods</strong> can be used for:</p>
<ul>
<li class="fragment"><p>the identification axes of co-variation between several variables (<em>eg</em>: co-variation between climatic variables or soil variables along environmental gradients, co-variation of functional traits along specta of functional strategiesâ¦)</p></li>
<li class="fragment"><p>the study of ecological communities by jointly considering the occurrence or abundance of multiple species</p></li>
</ul>
</section>
<section id="structure-of-multivariate-data" class="slide level2 smaller">
<h2>Structure of multivariate data</h2>
<p><span style="color:indianred;"><em>n</em></span> observations (in row) of <span style="color:indianred;"><em>p</em></span> variables (in column), where <span style="color:indianred;"><span class="math inline">\(x_{ij}\)</span></span> is the value of the variable <span style="color:indianred;"><em>j</em></span> for observation <span style="color:indianred;"><em>i</em></span>:</p>
<span class="math display">\[\begin{bmatrix}
x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1p} \\
x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{np}
\end{bmatrix}\]</span>
<p><span class="fragment"><em>Example:</em></span></p>
<ul>
<li class="fragment"><p>values of <em>p</em> environmental variables in <em>n</em> sites (observations)</p></li>
<li class="fragment"><p>floristic composition (<em>p</em> species = variables) in <em>n</em> sites</p></li>
<li class="fragment"><p>values of <em>p</em> functional traits (variables) for <em>n</em> species (observations)</p></li>
</ul>
<aside class="notes">
<p>in the second ex, the species are the variables and the sites the observations</p>
<p>but in 3rd ex, the species are the observation and the functional traits their variables</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="package-vegan" class="slide level2">
<h2>Package <em>vegan</em></h2>
<p>There are many packages to do multivariate analyses: <span style="color:indianred;">stats</span> (base package), <span style="color:indianred;">ade4</span>, <span style="color:indianred;">FactoMine</span>, <span style="color:indianred;">vegan</span>.</p>
<p>We will mostly work with <span style="color:indianred;">vegan</span>, letâs load it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(vegan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: permute</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is vegan 2.6-8</code></pre>
</div>
</div>
</section>
<section id="lets-work-with-data-on-understory-vegetation-in-fennoscandia" class="slide level2 smaller">
<h2>Letâs work with data on understory vegetation in Fennoscandia</h2>
<p><span style="font-size: 30px">These data are available in the package <span style="color:indianred;">vegan</span> and include:</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><span style="font-size: 30px">A floristic table of cover of understory vegetation (species in colum and sites in row):</span></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">data</span>(varespec)</span>
<span id="cb5-2"><a href=""></a>varespec[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="co"># display only a subset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>   Callvulg Empenigr Rhodtome Vaccmyrt Vaccviti
18     0.55    11.13     0.00     0.00    17.80
15     0.67     0.17     0.00     0.35    12.13
24     0.10     1.55     0.00     0.00    13.47
27     0.00    15.13     2.42     5.92    15.97
23     0.00    12.68     0.00     0.00    23.73</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><span style="font-size: 30px">Soil data on the 24 plots</span></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="fu">data</span>(varechem)</span>
<span id="cb7-2"><a href=""></a>varechem[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="co"># display only a subset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>      N    P     K    Ca    Mg
18 19.8 42.1 139.9 519.4  90.0
15 13.4 39.1 167.3 356.7  70.7
24 20.2 67.7 207.1 973.3 209.1
27 20.6 60.8 233.7 834.0 127.2
23 23.8 54.5 180.6 777.0 125.8</code></pre>
</div>
</div>
</div>
</div></div>
<p><span class="fragment"><span style="font-size: 22px">For more information on these data see <a href="https://www.researchgate.net/publication/227830523_Effects_of_reindeer_grazing_on_vegetation_in_dry_Pinus_sylvestris_forests" data-preview-link="false">VÃ¤re,Ohtonen and Oksanen (1995)</a></span></span></p>
<aside class="notes">
<p>Fennoscandia: Norway + Sweden + Finland + Parts of Russia</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section>
<section id="unconstrained-ordination-methods" class="title-slide slide level1 center">
<h1>Unconstrained ordination methods</h1>
<!-- ressource

https://gavinsimpson.github.io/physalia-multivariate/03-wednesday/slides.html#1

https://r.qcbs.ca/workshop09/book-en/setting-up-our-goals.html

Marchand + Eric -->
</section>
<section id="principle" class="slide level2">
<h2>Principle</h2>
<p><span style="font-size: 30px">Unconstrained ordination methods are used to <strong>visualise and explore the relationships among variables or observations</strong> without imposing any specific constraints on the relationships.</span></p>
<p><span style="font-size: 30px">The objective is to <strong>identify a few axes that capture most of the variation</strong> in a multidimensional dataset, allowing for a simplified yet informative representation.</span></p>
<p><span style="font-size: 30px">This allows to <strong>visualise similarities among observations</strong>, as more similar observations will be closer in the reduced-dimensional spaces.</span></p>
<!-- voir aussi Marchand session 2 sur l'explication des diffÃ©rentes distances-->
</section>
<section id="pca---principle" class="slide level2">
<h2>PCA - Principle</h2>
<p><span style="font-size: 30px">In a cloud of observations in a p-dimension space (<em>p</em> variables), a <strong>Principal Components Analysis</strong> fits:</span></p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li class="fragment"><p><span style="font-size: 30px">a <span style="color:red;">first line</span> minimising the <strong>Euclidean distance</strong> between the line and the observations, hence maximising the variance captured.</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">a <span style="color:lightgreen;">second line</span>, orthogonal to the first one, capturing the maximum remaining variance.</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">a third, a fourth, â¦. until we have <span class="math inline">\(p\)</span> lines</span></p></li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="PCA3.png"> <span style="font-size: 22px">Source: <a href="https://ericmarcon.github.io/Cours-R-Geeft/Ordination.html" data-preview-link="false">E. Marcon</a></span></p>
</div></div>
<p><span class="fragment"><span style="font-size: 30px">Each of these lines is a <strong>Principal Component</strong> (PC) and is associated with an <strong>eigenvalue</strong> indicating how much variance it explains.</span></span></p>
<aside class="notes">
<p>here we are in 3D but work the same in 4D, 5D, NDâ¦</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pca---principle-1" class="slide level2">
<h2>PCA - Principle</h2>
<p><span style="font-size: 30px">Alternative representation:</span></p>
<p><img data-src="PCA4.png"> <span style="font-size: 22px">Source: <a href="https://gavinsimpson.github.io/physalia-multivariate/02-tuesday" data-preview-link="false">G. Simpson</a></span></p>
</section>
<section id="pca---running-a-pca" class="slide level2">
<h2>PCA - Running a PCA</h2>
<p>Letâs fit a PCA on the soil data, using the function <span style="color:indianred;">pca</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a>soil_pca <span class="ot">&lt;-</span> <span class="fu">pca</span>(varechem, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
<p><span class="fragment">â ï¸ As the PCA is based on Euclidean distances, the variables needs to be express in comparable units. For this, we need to <strong>standardise</strong> them to a mean of 0 and a standard deviation of 1, using the argument <em>scale = TRUE</em></span></p>
</section>
<section id="pca---output" class="slide level2 smaller">
<h2>PCA - Output</h2>
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">summary</span>(soil_pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
pca(X = varechem, scale = TRUE) 

Partitioning of correlations:
              Inertia Proportion
Total              14          1
Unconstrained      14          1

Eigenvalues, and their contribution to the correlations 

Importance of components:
                         PC1    PC2    PC3     PC4     PC5     PC6     PC7
Eigenvalue            5.1916 3.1928 1.6855 1.06899 0.81599 0.70581 0.43641
Proportion Explained  0.3708 0.2281 0.1204 0.07636 0.05829 0.05042 0.03117
Cumulative Proportion 0.3708 0.5989 0.7193 0.79564 0.85392 0.90434 0.93551
                          PC8    PC9    PC10    PC11    PC12     PC13     PC14
Eigenvalue            0.36884 0.1707 0.14953 0.08526 0.06986 0.035057 0.023615
Proportion Explained  0.02635 0.0122 0.01068 0.00609 0.00499 0.002504 0.001687
Cumulative Proportion 0.96185 0.9740 0.98473 0.99082 0.99581 0.998313 1.000000</code></pre>
</div>
</div>
</div><div class="column" style="width:30%;">
<ul>
<li class="fragment"><p>The inertia is the total variance (all of it is unconstrained).</p></li>
<li class="fragment"><p>The eigenvalues are the variance explained by each PC.</p></li>
<li class="fragment"><p>We also get the proportion of variance explained by each PC, an the cumulative proportion.</p></li>
</ul>
</div></div>
</section>
<section id="pca---importance-of-components" class="slide level2">
<h2>PCA - Importance of components</h2>
<p><span style="font-size: 30px">As the objective is to reduce the dimensionality of our data, we will only interpret a small number of PCs.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">screeplot</span>(soil_pca, <span class="at">bstick =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-6-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span class="fragment"><span style="font-size: 30px">The <span style="color:indianred;">screeplot</span> shows the variance explained by each PC.</span></span></p>
<p><span class="fragment"><span style="font-size: 30px">The broken stick distribution shows the expected distribution of the variance if it was randomly distributed among PCs.</span></span></p>
</div></div>
<p><span class="fragment"><span style="font-size: 30px">Here we can focus on the two first PCs.</span></span></p>
<aside class="notes">
<p>on the y axis, we find the first line ofthe table in the output (the eigenvalues)</p>
<p>her the 2 first axes explained more than if random, the other axes explain less</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pca---visualisation" class="slide level2">
<h2>PCA - Visualisation</h2>
<p>A <span style="color:indianred;">biplot</span> shows the observations and variables in a same 2d-space defined by the chosen PCs:</p>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">biplot</span>(soil_pca, <span class="at">scaling =</span> <span class="st">"symmetric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-7-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:40%;">
<p><span class="fragment"><span style="font-size: 30px">The red arrows represent the variables, and the black numbers the observations (here the <em>sites</em>).</span></span></p>
<p><span class="fragment"><span style="font-size: 30px">The longer the arrows, the better the variable is represented by the displayed PCs.</span></span></p>
</div></div>
<aside class="notes">
<p>the default PCs are the 1 an 2, but we can choose</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pca---visualisation-1" class="slide level2">
<h2>PCA - Visualisation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="font-size: 30px">To focus on the <strong>observations</strong>, we chose <em>type 1 scaling</em> that attempts to preserved the distances.</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="fu">biplot</span>(soil_pca, <span class="at">scaling =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-8-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span style="font-size: 30px">The distance between two observations can be interpreted as their similarity.</span></p>
<p><span class="fragment"><span style="font-size: 25px">ð¡ In <span style="color:indianred;">vegan</span>, type 1 scaling can be obtained by <em>scaling = âsitesâ</em>.</span></span></p>
</div></div>
<aside class="notes">
<p>eg: here sites 5, 6, 7, 3 are clode, so soil more similar</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pca---visualisation-2" class="slide level2">
<h2>PCA - Visualisation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="font-size: 30px">To focus on the <strong>variables</strong>, we chose <em>type 2 scaling</em>:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="fu">biplot</span>(soil_pca, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-9-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span style="font-size: 30px">The angles between variables reflect their correlations.</span></p>
<ul>
<li class="fragment"><p><span style="font-size: 30px">Variables at 180Â° are negatively correlated.</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">Variables at 0Â° are positively correlated.</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">Variables at 90Â° are not correlated.</span></p></li>
</ul>
<p><span class="fragment"><span style="font-size: 25px">ð¡ In <span style="color:indianred;">vegan</span>, type scaling can be obtained by <em>scaling = âspeciesâ</em>.</span></span></p>
</div></div>
<aside class="notes">
<p>here: ph, Fe and Al positivelly correlated, and negativelly correlated to Humdepth and Baresoil</p>
<p>P, S and are not correlated to these</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pca---visualisation-3" class="slide level2">
<h2>PCA - Visualisation</h2>
<p><span style="font-size: 30px">To represent different PCs, we can specify them using the argument <em>choice</em>:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">biplot</span>(soil_pca, <span class="at">scaling =</span> <span class="st">"symmetric"</span>, </span>
<span id="cb16-2"><a href=""></a>       <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="co"># PCs 1 and 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-10-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
<!-- TO DO carry on from here -->
</section>
<section id="ca---principle" class="slide level2">
<h2>CA - Principle</h2>
<p><span style="font-size: 35px">As PCA is based on Euclidean distances, it assumes <em>linear relationships</em> between variables, and between variables and underlying gradients.</span></p>
<p><span style="font-size: 35px">When analysing <strong>floristic composition along ecological gradients</strong> (with species as variables), this assumption is often violated, as many species exhibit <strong>unimodal distributions</strong> along gradients.</span></p>
<div class="fragment">
<p><span style="font-size: 35px">For this type of data, we can use a <strong>Correspondence Analysis</strong> (CA), based on <span class="math inline">\(\chi^2\)</span> distances, which are better suited for detecting unimodal responses.</span></p>
<p><span style="font-size: 35px">In addition, CA is <em>not</em> affected by double zeros: sites with a lot of shared absences are <em>not</em> interpreted as being more similar.</span></p>
</div>
</section>
<section id="ca---running-a-ca" class="slide level2">
<h2>CA - Running a CA</h2>
<p>We can run a CA on a floristic table, <em>i.e.</em> a contingency table presenting the presence/absence or the abundance of <em>p</em> species in <em>n</em> sites.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a>varespec[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="co"># display only a subset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>   Callvulg Empenigr Rhodtome Vaccmyrt Vaccviti
18     0.55    11.13     0.00     0.00    17.80
15     0.67     0.17     0.00     0.35    12.13
24     0.10     1.55     0.00     0.00    13.47
27     0.00    15.13     2.42     5.92    15.97
23     0.00    12.68     0.00     0.00    23.73</code></pre>
</div>
</div>
<div class="fragment">
<p>To run a CA in <span style="color:indianred;">vegan</span>, we use the function <span style="color:indianred;">ca</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a>veg_ca <span class="ot">&lt;-</span> <span class="fu">ca</span>(varespec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</div>
<aside class="notes">
<p>here cover (not abundance) thatâs why we have decimal numbers</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="ca---output" class="slide level2 smaller">
<h2>CA - Output</h2>
<div class="columns">
<div class="column" style="width:70%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="fu">summary</span>(veg_ca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
ca(X = varespec) 

Partitioning of scaled Chi-square:
              Inertia Proportion
Total           2.083          1
Unconstrained   2.083          1

Eigenvalues, and their contribution to the scaled Chi-square 

Importance of components:
                         CA1    CA2    CA3     CA4     CA5     CA6     CA7
Eigenvalue            0.5249 0.3568 0.2344 0.19546 0.17762 0.12156 0.11549
Proportion Explained  0.2520 0.1713 0.1125 0.09383 0.08526 0.05835 0.05544
Cumulative Proportion 0.2520 0.4233 0.5358 0.62962 0.71489 0.77324 0.82868
                          CA8     CA9    CA10    CA11    CA12    CA13     CA14
Eigenvalue            0.08894 0.07318 0.05752 0.04434 0.02546 0.01710 0.014896
Proportion Explained  0.04269 0.03513 0.02761 0.02129 0.01222 0.00821 0.007151
Cumulative Proportion 0.87137 0.90650 0.93411 0.95539 0.96762 0.97583 0.982978
                          CA15     CA16     CA17     CA18     CA19      CA20
Eigenvalue            0.010160 0.007830 0.006032 0.004008 0.002865 0.0019275
Proportion Explained  0.004877 0.003759 0.002896 0.001924 0.001375 0.0009253
Cumulative Proportion 0.987855 0.991614 0.994510 0.996434 0.997809 0.9987341
                           CA21      CA22      CA23
Eigenvalue            0.0018074 0.0005864 0.0002434
Proportion Explained  0.0008676 0.0002815 0.0001168
Cumulative Proportion 0.9996017 0.9998832 1.0000000</code></pre>
</div>
</div>
</div><div class="column" style="width:30%;">
<ul>
<li class="fragment"><p>The output of a CA is very similar to a PCA.</p></li>
<li class="fragment"><p>We get the eigenvalues explained by each Correspondence Axis (CA).</p></li>
</ul>
</div></div>
</section>
<section id="ca---importance-of-components" class="slide level2">
<h2>CA - Importance of components</h2>
<p><span style="font-size: 30px">As with a PCA, we can look at the variance explained by each CA:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">screeplot</span>(veg_ca, <span class="at">bstick =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-14-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<p>here we would consider 5 axes</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="ca---visualisation" class="slide level2 smaller">
<h2>CA - Visualisation</h2>
<p><span style="font-size: 30px">In CA biplots, species are shown as points representing the optima of the species along the gradients. Abundance of species declines in concentric circles away from the optima.</span></p>
<div class="columns">
<div class="column" style="width:33%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="fu">plot</span>(veg_ca, <span class="at">scaling =</span> <span class="st">"species"</span>,</span>
<span id="cb23-2"><a href=""></a>     <span class="at">main =</span> <span class="st">"Scaling: species"</span>) <span class="co"># title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-15-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">plot</span>(veg_ca, <span class="at">scaling =</span> <span class="st">"sites"</span>,</span>
<span id="cb24-2"><a href=""></a>     <span class="at">main =</span> <span class="st">"Scaling: sites"</span>) <span class="co"># title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-16-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="fu">plot</span>(veg_ca, <span class="at">scaling =</span> <span class="st">"symmetric"</span>,</span>
<span id="cb25-2"><a href=""></a>     <span class="at">main =</span> <span class="st">"Scaling: symmetric"</span>) <span class="co"># title</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-17-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p><span class="fragment"><span style="font-size: 25px">ð¡ To visualise a CA, we use the function <span style="color:indianred;">plot</span>. The use of scaling is similar to a PCA.</span></span></p>
</section>
<section id="ca---visualisation-1" class="slide level2 smaller">
<h2>CA - Visualisation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="font-size: 30px">We can focus on the speciesâ¦</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a><span class="fu">plot</span>(veg_ca, <span class="at">scaling =</span> <span class="st">"species"</span>,</span>
<span id="cb26-2"><a href=""></a>     <span class="at">main =</span> <span class="st">"Scaling: species"</span>, <span class="co"># title</span></span>
<span id="cb26-3"><a href=""></a>     <span class="at">display =</span> <span class="st">"species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-18-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
<p><span class="fragment"><span style="font-size: 28px">The proximity of species indicate that they are presents in similar sites.</span></span></p>
</div><div class="column" style="width:50%;">
<p><span style="font-size: 30px">â¦ or on the sites.</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="fu">plot</span>(veg_ca, <span class="at">scaling =</span> <span class="st">"sites"</span>,</span>
<span id="cb27-2"><a href=""></a>     <span class="at">main =</span> <span class="st">"Scaling: sites"</span>, <span class="co"># title</span></span>
<span id="cb27-3"><a href=""></a>     <span class="at">display =</span> <span class="st">"sites"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-19-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
<p><span class="fragment"><span style="font-size: 28px">The proximity of sites indicate that they have similar communities.</span></span></p>
</div></div>
<aside class="notes">
<p>look at examples on the plots</p>
<p>species that are encounter together or on the contrary, not encountered together</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pcoa---principle" class="slide level2">
<h2>PCoA - Principle</h2>
<p><span style="font-size: 30px">The <strong>Principal Coordinate Analysis</strong> (PCoA), also called <strong>metric multidimentional scaling</strong> (MDS), is a more general method.</span></p>
<p><span style="font-size: 30px">PCoA can use many types of distance (not only Euclidean or <span class="math inline">\(\chi^2\)</span>):</span></p>
<ul>
<li class="fragment"><p><span style="font-size: 30px">for abundance data, we often used the distance of <strong>Bray-Curtis</strong>.</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">for presence/absence data, we often use the distance of <strong>Jaccard</strong> (<em>i.e.</em> 1 - Jaccard Index).</span></p></li>
</ul>
<p><span class="fragment"><span style="font-size: 30px">These distances range from 0 (identical species composition) to 1 (no shared species). They focus on shared abundance and thus ignore the double absences.</span></span></p>
<p><span class="fragment"><span style="font-size: 25px">ð¡ A PCoA with Euclidian distance is equivalent to a PCA, and with <span class="math inline">\(\chi^2\)</span> distance to a CA.</span></span></p>
<aside class="notes">
<p>as seen PCA: euclidian distane</p>
<p>CA: chi2 distance</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pcoa---running-a-pcoa" class="slide level2 smaller">
<h2>PCoA - Running a PCoA</h2>
<p><span style="font-size: 30px">Letâs do a PCoA on abundance data using Bray-Curtis distance.</span></p>
<p><span style="font-size: 30px">We first need to calculate the distance between sites, using <span style="color:indianred;">vegdist</span>:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href=""></a>veg_dist <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(varespec, <span class="at">method =</span> <span class="st">"bray"</span>)</span>
<span id="cb28-2"><a href=""></a>veg_dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>          18        15        24        27        23        19        22
15 0.5310021                                                            
24 0.6680661 0.3597783                                                  
27 0.5621247 0.4055610 0.4934947                                        
23 0.3747078 0.3652097 0.5020306 0.4286111                              
19 0.5094738 0.4560757 0.5092318 0.4878190 0.3606242                    
22 0.6234419 0.3579517 0.5010050 0.4655224 0.4812706 0.4726483          
16 0.5337610 0.3976674 0.5907623 0.5683930 0.4094312 0.4496731 0.2678031
28 0.8418209 0.5225414 0.5736665 0.3027802 0.6979519 0.6431734 0.5985666
13 0.3453347 0.6063846 0.7576747 0.7543736 0.6221471 0.5739244 0.6948736
14 0.5449810 0.4803756 0.6533606 0.7467915 0.5645808 0.6331942 0.5357609
20 0.3879069 0.3784188 0.4346892 0.4957833 0.2877014 0.3953776 0.4627020
25 0.6318891 0.3376115 0.3369098 0.5001593 0.4258617 0.4311299 0.3822981
7  0.3603697 0.6717391 0.7931069 0.7792917 0.6390838 0.6958570 0.7459886
5  0.4955699 0.7178612 0.8561753 0.8732190 0.7295255 0.7898205 0.8611451
6  0.3382309 0.6355122 0.7441373 0.7496935 0.6252483 0.5684030 0.7249162
3  0.5277480 0.7578503 0.8382119 0.8090236 0.7128798 0.5302756 0.8026152
4  0.4694018 0.6843974 0.8309875 0.8413800 0.7117919 0.5177604 0.8015314
2  0.5724092 0.8206269 0.8372551 0.7581924 0.7249869 0.5389222 0.8321464
9  0.6583569 0.7761039 0.7590517 0.7415898 0.6693889 0.5393143 0.7725082
12 0.4688038 0.6794199 0.6894538 0.6253616 0.5384762 0.4288556 0.7051751
10 0.6248996 0.7644564 0.7842829 0.7096540 0.6625476 0.5059910 0.7875328
11 0.4458523 0.4716274 0.5677373 0.6322919 0.4710280 0.3293493 0.5812219
21 0.5560864 0.7607281 0.7272727 0.5456001 0.4951221 0.5315894 0.6771167
          16        28        13        14        20        25         7
15                                                                      
24                                                                      
27                                                                      
23                                                                      
19                                                                      
22                                                                      
16                                                                      
28 0.7015360                                                            
13 0.5514941 0.8600122                                                  
14 0.4826350 0.8239667 0.5547565                                        
20 0.3737797 0.6963560 0.5785542 0.5115258                              
25 0.4306058 0.6086150 0.7412605 0.5541517 0.4518556                    
7  0.6596144 0.8960202 0.4533054 0.6550830 0.5959162 0.7556726          
5  0.7184789 0.9539592 0.5148988 0.7257681 0.7153827 0.8600858 0.3237446
6  0.6509879 0.9014440 0.3515673 0.6227473 0.5439118 0.7343872 0.1754713
3  0.6837953 0.9234485 0.4965478 0.7836661 0.6690479 0.8168684 0.5154487
4  0.6462648 0.9381169 0.3881748 0.6734743 0.6771854 0.8400134 0.5601721
2  0.7354202 0.9053213 0.5968691 0.8592489 0.6951539 0.8179089 0.6465777
9  0.8185866 0.8686670 0.7292530 0.8282497 0.6982486 0.7884243 0.8318435
12 0.6342166 0.8543167 0.5902386 0.7507074 0.5182426 0.7062564 0.6991666
10 0.7656598 0.9016604 0.7160439 0.8304088 0.6706349 0.7845955 0.7697453
11 0.5172825 0.7544064 0.4272808 0.6743277 0.4461712 0.6175930 0.5262233
21 0.7474559 0.7248773 0.7212772 0.8096450 0.6320431 0.7466232 0.7933350
           5         6         3         4         2         9        12
15                                                                      
24                                                                      
27                                                                      
23                                                                      
19                                                                      
22                                                                      
16                                                                      
28                                                                      
13                                                                      
14                                                                      
20                                                                      
25                                                                      
7                                                                       
5                                                                       
6  0.3984538                                                            
3  0.5634432 0.4517627                                                  
4  0.5377506 0.4665100 0.3592689                                        
2  0.7257597 0.5552754 0.2099203 0.4841145                              
9  0.9014583 0.7223126 0.3885811 0.6222340 0.2330286                    
12 0.7808641 0.5762462 0.2641851 0.4870742 0.1846147 0.2277228          
10 0.8504191 0.6567926 0.3413378 0.5776062 0.1456729 0.1117280 0.1793368
11 0.5563798 0.4077948 0.3002597 0.3215966 0.4209596 0.5145260 0.3688102
21 0.8888316 0.6720141 0.7507773 0.7641304 0.6779661 0.5952563 0.5602137
          10        11
15                    
24                    
27                    
23                    
19                    
22                    
16                    
28                    
13                    
14                    
20                    
25                    
7                     
5                     
6                     
3                     
4                     
2                     
9                     
12                    
10                    
11 0.5043578          
21 0.6147874 0.6713363</code></pre>
</div>
</div>
<aside class="notes">
<p>explain the distance matrix between pairs of plots</p>
<p>explain why triange (as the matrix is symetrical and diagonale not shown (would be 0))</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pcoa---running-a-pcoa-1" class="slide level2">
<h2>PCoA - Running a PCoA</h2>
<p><span style="font-size: 30px">We use <span style="color:indianred;">pco</span> to run a PCoA.</span></p>
<p><span style="font-size: 30px">When using Bray-Curtis distance, we can get negative eigenvalues (corresponding to distances in an imaginary space). To avoid this, we can do a Lingoes correction.</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a>veg_pcoa <span class="ot">&lt;-</span> <span class="fu">pco</span>(veg_dist, </span>
<span id="cb30-2"><a href=""></a>                <span class="at">add =</span> <span class="st">"lingoes"</span>) <span class="co"># correction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</section>
<section id="pcoa---output" class="slide level2 smaller">
<h2>PCoA - Output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="fu">summary</span>(veg_pcoa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in summ$call &lt;- object$call: Coercing LHS to a list</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
pco(X = veg_dist, add = "lingoes") 

Partitioning of Lingoes adjusted squared Bray distance:
              Inertia Proportion
Total            6.25          1
Unconstrained    6.25          1

Eigenvalues, and their contribution to the Lingoes adjusted squared Bray distance 

Importance of components:
                        MDS1   MDS2    MDS3    MDS4    MDS5    MDS6    MDS7
Eigenvalue            1.8294 1.2076 0.51704 0.44394 0.31949 0.27023 0.24925
Proportion Explained  0.2927 0.1932 0.08273 0.07104 0.05112 0.04324 0.03988
Cumulative Proportion 0.2927 0.4859 0.56867 0.63971 0.69083 0.73407 0.77395
                         MDS8    MDS9   MDS10   MDS11  MDS12   MDS13   MDS14
Eigenvalue            0.20259 0.17130 0.15010 0.13786 0.1325 0.11363 0.09141
Proportion Explained  0.03242 0.02741 0.02402 0.02206 0.0212 0.01818 0.01463
Cumulative Proportion 0.80636 0.83377 0.85779 0.87985 0.9010 0.91923 0.93385
                        MDS15   MDS16   MDS17    MDS18   MDS19    MDS20
Eigenvalue            0.07924 0.07373 0.06767 0.060824 0.04874 0.036629
Proportion Explained  0.01268 0.01180 0.01083 0.009732 0.00780 0.005861
Cumulative Proportion 0.94653 0.95833 0.96916 0.978890 0.98669 0.992551
                         MDS21    MDS22
Eigenvalue            0.026132 0.020424
Proportion Explained  0.004181 0.003268
Cumulative Proportion 0.996732 1.000000</code></pre>
</div>
</div>
<aside class="notes">
<p>we can ignore the warning, if we are just visualising the summary (and not doing anything afterwards)</p>
<p>same kind of output (but here MDS for metric multidimensional scalling)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pcoa---importance-of-components" class="slide level2">
<h2>PCoA - Importance of components</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href=""></a><span class="fu">screeplot</span>(veg_pcoa, <span class="at">bstick =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-23-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<p>idem other methods</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="pcoa---visualisation" class="slide level2 smaller">
<h2>PCoA - Visualisation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="font-size: 30px">We plot the observations using <span style="color:indianred;">plot</span> and then add the species scores:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="co"># get species scores</span></span>
<span id="cb35-2"><a href=""></a>scrs <span class="ot">&lt;-</span> <span class="fu">scores</span>(veg_pcoa, </span>
<span id="cb35-3"><a href=""></a>               <span class="at">choices =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="co"># axes</span></span>
<span id="cb35-4"><a href=""></a></span>
<span id="cb35-5"><a href=""></a><span class="co"># take the weighted averages scores </span></span>
<span id="cb35-6"><a href=""></a>  <span class="co"># (weighed by abundance)</span></span>
<span id="cb35-7"><a href=""></a>spp_scrs <span class="ot">&lt;-</span> <span class="fu">wascores</span>(scrs,</span>
<span id="cb35-8"><a href=""></a>                     varespec) <span class="co"># weights</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href=""></a><span class="co"># plot the sites</span></span>
<span id="cb36-2"><a href=""></a><span class="fu">plot</span>(veg_pcoa)</span>
<span id="cb36-3"><a href=""></a></span>
<span id="cb36-4"><a href=""></a><span class="co"># add species to the plot</span></span>
<span id="cb36-5"><a href=""></a><span class="fu">text</span>(spp_scrs, <span class="at">labels =</span> <span class="fu">rownames</span>(spp_scrs), </span>
<span id="cb36-6"><a href=""></a>     <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>) <span class="co"># color and size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-25-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>results are not far from the one obtained with the CA</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="nmds---principle" class="slide level2">
<h2>NMDS - Principle</h2>
<p><span style="font-size: 30px"><strong>Non-metric multidimentional scaling</strong> is an ordination method used in similar contexts as PCA, CA and PCoA, but working very differently:</span></p>
<ul>
<li class="fragment"><p><span style="font-size: 30px">as in PCoA, we can choose the measure of distance (usually Bray-Curtis)</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">the number of axes is set <em>a priori</em> (usually 2)</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">an iterative algorithm moves the sites until the distances between sites are the closest possible to the actual multivariate distances (based on the chosen distance metric).</span></p></li>
</ul>
<p><span class="fragment"><span style="font-size: 30px">NMDS is non-metric as it focussed on the <strong>rank order of distances</strong> rather than on the actual distance, making it very flexible and robust.</span></span></p>
</section>
<section id="nmds---running-a-nmds" class="slide level2">
<h2>NMDS - Running a NMDS</h2>
<p>We now work with the <span style="color:indianred;">dune</span> data, a floristic table of dune vegetation.</p>
<p>We run the NMDS using <span style="color:indianred;">metaMDS</span>. The default number of axes is <em>2</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">22</span>)</span>
<span id="cb37-2"><a href=""></a><span class="fu">data</span>(dune)</span>
<span id="cb37-3"><a href=""></a>dune_nmds <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(dune, </span>
<span id="cb37-4"><a href=""></a>                     <span class="at">distance =</span> <span class="st">"bray"</span>, <span class="co"># Bray-Curtis is the default</span></span>
<span id="cb37-5"><a href=""></a>                     <span class="at">trace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
<p><span class="fragment"><span style="font-size: 22px">As there is a random component in the analyse, Iâve set a seed so that we all get the same results.</span></span></p>
<aside class="notes">
<p>we change the data because varespec doesnât work very well hereâ¦</p>
<p>trace = FALSE is to avoid having having the output of each iteration</p>
<p>no need to set the seed, or can be set to any number</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="nmds---output" class="slide level2 smaller">
<h2>NMDS - Output</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a>dune_nmds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
metaMDS(comm = dune, distance = "bray", trace = FALSE) 

global Multidimensional Scaling using monoMDS

Data:     dune 
Distance: bray 

Dimensions: 2 
Stress:     0.1183186 
Stress type 1, weak ties
Best solution was repeated 5 times in 20 tries
The best solution was from try 7 (random start)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on 'dune' </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span style="font-size: 30px">The output gives:</span></p>
<ul>
<li class="fragment"><p><span style="font-size: 30px">a reminder of the data, the distance metric, the number of dimensions</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">the <strong>stress</strong>: a value &lt; 0.1 is good, a value &lt; 0.2 is acceptable, a value &gt; 0.2 is poor</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">the number of times the algorithm converged (number of best solutions). If less than 2 convergence, the result is unstable.</span></p></li>
</ul>
</div></div>
</section>
<section id="nmds---convergence-issue" class="slide level2 smaller">
<h2>NMDS - Convergence issue</h2>
<p><span style="font-size: 30px">If the algorithm does not converge, we can:</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><span style="font-size: 30px">add iterations from previous best solution:</span></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a>dune_nmds <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(dune, </span>
<span id="cb40-2"><a href=""></a>                     <span class="at">previous.best =</span> dune_nmds, </span>
<span id="cb40-3"><a href=""></a>                     <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-4"><a href=""></a>dune_nmds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
metaMDS(comm = dune, trace = FALSE, previous.best = dune_nmds) 

global Multidimensional Scaling using monoMDS

Data:     dune 
Distance: bray 

Dimensions: 2 
Stress:     0.1183186 
Stress type 1, weak ties
Best solution was repeated 3 times in 40 tries
The best solution was from try 36 (random start)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on 'dune' </code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><span style="font-size: 30px">or rerun the NMDS, increasing the number of iterations:</span></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="fu">metaMDS</span>(dune,</span>
<span id="cb42-2"><a href=""></a>        <span class="at">try =</span> <span class="dv">50</span>, <span class="co"># the default is 20</span></span>
<span id="cb42-3"><a href=""></a>        <span class="at">trace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</div>
</div></div>
<aside class="notes">
<p>second solution not ran</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="nmds---visualisation" class="slide level2">
<h2>NMDS - Visualisation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href=""></a><span class="fu">plot</span>(dune_nmds, </span>
<span id="cb43-2"><a href=""></a>     <span class="at">type =</span><span class="st">"t"</span>) <span class="co"># display the names of sites and species</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-30-1.png" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nmds---goodness-of-fit" class="slide level2">
<h2>NMDS - Goodness of fit</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="font-size: 30px">To assess the goodness of fit, we can plot a Shepard plot with <span style="color:indianred;">stressplot</span>:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a><span class="fu">stressplot</span>(dune_nmds,</span>
<span id="cb44-2"><a href=""></a>           <span class="at">main =</span> <span class="st">"Shepard plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-31-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><span style="font-size: 30px">The Shepard plot shows ordination distance <em>vs</em> observed dissimilarity.</span></p>
<p><span style="font-size: 30px">It also gives the R<sup>2</sup>, for non-metric fit <span class="math display">\[R^2 = 1 - Stress^2\]</span></span></p>
<ul>
<li class="fragment"><p><span style="font-size: 30px">The smaller the <em>stress</em>, the better the fit.</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">The higher the <em>R<sup>2</sup></em>, the better the fit.</span></p></li>
</ul>
</div>
</div></div>
<aside class="notes">
<p>Shepard plot:</p>
<ul>
<li><p>x-axis: the observed dissimilarity (here calculated wuth Bray-Curtis)</p></li>
<li><p>y-axis: the distance between sites observations in the NMDS ordination space</p></li>
<li><p>the closser the point are to the diagonal, the better the fit (we donât expect the points to be on a 1:1 diagonal as the distance are not the same)</p></li>
</ul>
<p>steps = groups of tied or nearly tied dissimilarity values being assigned the same rank</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="nmds---number-of-dimensions" class="slide level2 smaller">
<h2>NMDS - Number of dimensions</h2>
<p><span style="font-size: 30px">To see how the stress decreases when we add dimensions, we can fit a NMDS with number of dimensions ranging from 1 to 10 (or more), and plot the stress <em>vs</em> the number of dimensions:</span></p>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href=""></a>k_vec <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span> <span class="co"># number of dimensions</span></span>
<span id="cb45-2"><a href=""></a>stress <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_vec)) <span class="co"># create a vector of numeric</span></span>
<span id="cb45-3"><a href=""></a>veg_dij <span class="ot">&lt;-</span> <span class="fu">metaMDSdist</span>(dune, <span class="at">trace =</span> <span class="cn">FALSE</span>) <span class="co"># calculate dissimilarities</span></span>
<span id="cb45-4"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb45-5"><a href=""></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(k_vec)) { <span class="co"># run an NMDS for 1 to 10 dimensions</span></span>
<span id="cb45-6"><a href=""></a>    sol <span class="ot">&lt;-</span> <span class="fu">metaMDSiter</span>(veg_dij, <span class="at">k =</span> i, <span class="co"># run the NMDS</span></span>
<span id="cb45-7"><a href=""></a>                       <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-8"><a href=""></a>    stress[i] <span class="ot">&lt;-</span> sol<span class="sc">$</span>stress <span class="co"># extract the stress</span></span>
<span id="cb45-9"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a><span class="fu">plot</span>(k_vec, stress, <span class="at">type =</span> <span class="st">"b"</span>, </span>
<span id="cb46-2"><a href=""></a>     <span class="at">ylab =</span> <span class="st">"Stress"</span>, <span class="at">xlab =</span> <span class="st">"Dimensions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-33-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>we will see loops later</p>
<p>here we calculate the dissimilarity outside the loop as it is not random, so no need to do it several tumes</p>
<p>and seq_along generate a sequence of interger of the same length as k_vec</p>
<p>type =âbâ give the lines between the dots</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="summary-on-unconstrained-ordination-methods" class="slide level2 smaller">
<h2>Summary on unconstrained ordination methods</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<colgroup>
<col style="width: 4%">
<col style="width: 31%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Principle</th>
<th style="text-align: left;">Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PCA</td>
<td style="text-align: left;">Linear method based on Euclidian distance</td>
<td style="text-align: left;">Environmental data (or species data on short gradients)</td>
</tr>
<tr class="even">
<td style="text-align: left;">CA</td>
<td style="text-align: left;">Unimodal method based on chi<sup>2</sup> distance</td>
<td style="text-align: left;">Species data with non linear responses. chi<sup>2</sup> give more weight to rare species than Bray-Curtis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PCoA</td>
<td style="text-align: left;">Metric based on several types of distances</td>
<td style="text-align: left;">Any kind of data. Bray-Curtis more sensitive to abundant species</td>
</tr>
<tr class="even">
<td style="text-align: left;">NMDS</td>
<td style="text-align: left;">Based on rank, with several types of distances</td>
<td style="text-align: left;">Very flexible and robust for non-linear responses, many zerosâ¦</td>
</tr>
</tbody>
</table>
</div>
</div>
<aside class="notes">
<p>!!! if PCA on presence/abs or abundance =&gt; need to do a transformation before, we will see this in a moment</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="clustering" class="title-slide slide level1 center">
<h1>Clustering</h1>

</section>
<section id="principle-1" class="slide level2">
<h2>Principle</h2>
<p><strong>Hierachical clustering</strong> aims to create <strong>groups</strong> of observations that are similar across a set of variables.</p>
<p>Observations are progressively aggregated based on their similarity until all are merged into a single group.</p>
<p>The clustering results in a tree-like structure called <strong>dendrogram</strong>, which illustrates the proximity between observations.</p>
</section>
<section id="performing-the-clustering" class="slide level2">
<h2>Performing the clustering</h2>
<p>Letâs do a clustering of the plots based on the soil data.</p>
<ul>
<li class="fragment">As for the PCA, we first need to standardise the variables:</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a>soil_norm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(varechem))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</div>
<ul>
<li class="fragment">We then compute the distance matrix:</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a>soil_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(soil_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</div>
<ul>
<li class="fragment">We then perform the clustering using <span style="color:indianred;">hclust</span>. Here we use the method of Ward:</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a>soil_clust <span class="ot">&lt;-</span> <span class="fu">hclust</span>(soil_dist, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
</div>
<aside class="notes">
<p>here the distance is euclidian (default value)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="different-methods-of-clustering" class="slide level2">
<h2>Different methods of clustering</h2>
<p>Different methods of clustering can be used.</p>
<ul>
<li class="fragment"><p><em>Ward clustering</em> minimise intra-group variance</p></li>
<li class="fragment"><p><em>single linkage</em>: connects clusters based on the shortest distance between any two points within those clusters</p></li>
<li class="fragment"><p><em>complete linkage</em>: connects clusters based on the longest distance between any two points within those clusters</p></li>
<li class="fragment"><p><em>average linkage</em>: connects clusters based on the average distance between all pairs of points within those clusters</p></li>
</ul>
<p><span class="fragment"><span style="font-size: 30px">The best methods depends on the data, but the Ward method is often a good choice.</span></span></p>
</section>
<section id="dendrogram" class="slide level2">
<h2>Dendrogram</h2>
<div class="columns">
<div class="column" style="width:70%;">
<p><span style="font-size: 30px">We use <span style="color:indianred;">plot</span> to get the dendrogram.</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a><span class="fu">plot</span>(soil_clust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-38-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:30%;">
<ul>
<li class="fragment"><p><span style="font-size: 30px">Horizontal lines represent grouping.</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">The length of vertical lines correspond to the distance between groupings.</span></p></li>
</ul>
</div></div>
<p><span class="fragment"><span style="font-size: 30px">Here there is not obvious choice for the number of groupsâ¦ We can possibly make 3 or 5 groups.</span></span></p>
<aside class="notes">
<p>vertical distance: here for instance, making 2 groups is not very different from making 3 groups</p>
<p>voir aussi around 16, 18, 14</p>
<p>show on the backboard an example where we would have a clear choice</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="extract-the-groups" class="slide level2">
<h2>Extract the groups</h2>
<p>We can extract the groups using <span style="color:indianred;">cutree</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a><span class="co"># 3 groups</span></span>
<span id="cb51-2"><a href=""></a>soil_3_group <span class="ot">&lt;-</span> <span class="fu">cutree</span>(soil_clust, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb51-3"><a href=""></a></span>
<span id="cb51-4"><a href=""></a><span class="co"># 5 groups</span></span>
<span id="cb51-5"><a href=""></a>soil_5_group <span class="ot">&lt;-</span> <span class="fu">cutree</span>(soil_clust, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb51-6"><a href=""></a>soil_5_group <span class="co"># this is a name vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>18 15 24 27 23 19 22 16 28 13 14 20 25  7  5  6  3  4  2  9 12 10 11 21 
 1  1  2  3  3  3  3  1  3  2  1  3  3  4  4  4  4  2  4  1  1  5  5  1 </code></pre>
</div>
</div>
</section>
<section id="compare-groups-with-pca" class="slide level2 smaller">
<h2>Compare groups with PCA</h2>
<p><span style="font-size: 30px">We can also represent the groups on the PCA biplot:</span></p>
<div class="columns">
<div class="column" style="width:65%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a><span class="co"># extract the scores of the sites on the two first PCs</span></span>
<span id="cb53-2"><a href=""></a>  dt_soil_groups <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scores</span>(soil_pca, </span>
<span id="cb53-3"><a href=""></a>                           <span class="at">scaling =</span> <span class="st">"sites"</span>, <span class="co"># type of scaling</span></span>
<span id="cb53-4"><a href=""></a>                           <span class="at">display =</span> <span class="st">"sites"</span>, <span class="co"># scores we want</span></span>
<span id="cb53-5"><a href=""></a>                           <span class="at">choices =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)) <span class="co"># axes</span></span>
<span id="cb53-6"><a href=""></a><span class="co"># check that plots are in the same order</span></span>
<span id="cb53-7"><a href=""></a>  <span class="fu">all</span>(<span class="fu">rownames</span>(dt_soil_groups) <span class="sc">==</span> <span class="fu">rownames</span>(soil_3_group))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href=""></a>  <span class="fu">all</span>(<span class="fu">rownames</span>(dt_soil_groups) <span class="sc">==</span> <span class="fu">rownames</span>(soil_5_group))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href=""></a><span class="co"># add groups to the PCs data </span></span>
<span id="cb57-2"><a href=""></a>  dt_soil_groups<span class="sc">$</span>G3 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(soil_3_group)</span>
<span id="cb57-3"><a href=""></a>  dt_soil_groups<span class="sc">$</span>G5 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(soil_5_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:35%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a><span class="fu">head</span>(dt_soil_groups)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>           PC1        PC2 G3 G5
18  0.03121361  0.4015541  1  1
15  0.12454124  0.1785911  1  1
24 -0.93563685 -0.6009084  2  2
27 -0.76510709  0.2452010  1  3
23 -0.43359367  0.4118759  1  3
19 -0.46389613  0.3523669  1  3</code></pre>
</div>
</div>
</div></div>
</section>
<section id="compare-groups-with-pca-1" class="slide level2 smaller">
<h2>Compare groups with PCA</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb60-2"><a href=""></a><span class="fu">ggplot</span>(dt_soil_groups,</span>
<span id="cb60-3"><a href=""></a>       <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> G3)) <span class="sc">+</span> </span>
<span id="cb60-4"><a href=""></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(dt_soil_groups)), </span>
<span id="cb60-5"><a href=""></a>            <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb60-6"><a href=""></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-42-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href=""></a><span class="co">#</span></span>
<span id="cb61-2"><a href=""></a><span class="fu">ggplot</span>(dt_soil_groups,</span>
<span id="cb61-3"><a href=""></a>       <span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> G5)) <span class="sc">+</span> </span>
<span id="cb61-4"><a href=""></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">rownames</span>(dt_soil_groups)),</span>
<span id="cb61-5"><a href=""></a>            <span class="at">size =</span> <span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb61-6"><a href=""></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-43-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
<p><span class="fragment"><span style="font-size: 30px">ð¡ Note how we retrieve the scores of the ordination to be able to use ggplot to customise the plot.</span></span></p>
<aside class="notes">
<p>you can retreive everything from the ordinations, need to check the vignette and help of the package vegan to learn how to do itâ¦</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="constrained-ordination-methods" class="title-slide slide level1 center">
<h1>Constrained ordination methods</h1>

</section>
<section id="principle-2" class="slide level2">
<h2>Principle</h2>
<p><span style="font-size: 30px">In constrained ordination methods, the choice of the axes is based on the response to explanatory variables. These methods combine the concepts of <strong>ordination</strong> and <strong>regression</strong>.</span></p>
<div class="fragment">
<p><span style="font-size: 30px">The objective of constrained ordinations is to identify <strong>relationships between a multivariate response table and a multivariate explanatory table</strong>.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="font-size: 28px">Constrained ordination can be used to identify relationships between the species composition of communities (here <em>Y</em>) and environmental variables (here <em>X</em>).</span></p>
</div><div class="column" style="width:50%;">
<p><img data-src="constrained.png"></p>
</div></div>
</div>
</section>
<section id="collinearity" class="slide level2 smaller">
<h2>Collinearity</h2>
<p><span style="font-size: 30px">As in multiple linear regression, we need to avoid collinearity of explanatory variables.</span></p>
<p><span style="font-size: 30px">In a real study, we will choose the variables to include based on our <strong>hypotheses</strong>.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="font-size: 30px">We can look use the PCA of soil variables to choose variables with little correlation:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href=""></a><span class="fu">biplot</span>(soil_pca, <span class="at">scaling =</span> <span class="dv">2</span>, <span class="at">display =</span> <span class="st">"species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-44-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span style="font-size: 30px">Letâs choose <em>pH</em>, <em>N</em>, <em>Mo</em>, <em>P</em>, and check how correlated they are:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href=""></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(soil_norm[,<span class="fu">c</span>(<span class="st">"pH"</span>, <span class="st">"N"</span>, <span class="st">"Mo"</span>, <span class="st">"P"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-45-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>here we are not going to formulate hyp as exercice</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="rda---principle" class="slide level2">
<h2>RDA - Principle</h2>
<p><strong>Redundancy analysis</strong> (RDA) is the constrained equivalent of Principal Component Analysis (PCA).</p>
<p>It is therefore based on Euclidean distance and assumes <strong>linear</strong> relationships between species and environmental variables.</p>
</section>
<section id="rda---hellinger-transformation" class="slide level2">
<h2>RDA - Hellinger transformation</h2>
<p>To do a RDA (or a PCA) on a table of abundance of species, a Hellinger transformation is required. Hellinger distance has a more linear response to changes in species abundance.</p>
<p>We can do this transformation using <span style="color:indianred;">decostand</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href=""></a>spec_hel <span class="ot">&lt;-</span> <span class="fu">decostand</span>(varespec, <span class="at">method  =</span><span class="st">"hellinger"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
<aside class="notes">
<p>Importance of Hellinger transfo for PCA as well</p>
<p>Obj of Hellinger transfo: reducing the influence of highly abundant species and dealing with the double-zero problem (shared absences)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="rda---running-a-rda" class="slide level2">
<h2>RDA - Running a RDA</h2>
<p><span style="font-size: 30px">We run the RDA with <span style="color:indianred;">rda</span>:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href=""></a>vare_rda <span class="ot">&lt;-</span> <span class="fu">rda</span>(spec_hel <span class="sc">~</span> pH <span class="sc">+</span> N <span class="sc">+</span> Mo <span class="sc">+</span> P, <span class="co"># formula</span></span>
<span id="cb65-2"><a href=""></a>                <span class="at">data =</span> soil_norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
<ul>
<li class="fragment"><p><span style="font-size: 30px">The formula is quite similar to the formula of a regression, but here the response variable is the abundance table (after Hellinger transformation).</span></p></li>
<li class="fragment"><p><span style="font-size: 30px">We use the soil explanatory variables that we already standardised.</span></p></li>
</ul>
</section>
<section id="rda---output" class="slide level2 smaller">
<h2>RDA - Output</h2>
<div class="columns">
<div class="column" style="width:65%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href=""></a><span class="fu">summary</span>(vare_rda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(formula = spec_hel ~ pH + N + Mo + P, data = soil_norm) 

Partitioning of variance:
              Inertia Proportion
Total          0.3647     1.0000
Constrained    0.1190     0.3262
Unconstrained  0.2457     0.6738

Eigenvalues, and their contribution to the variance 

Importance of components:
                         RDA1    RDA2    RDA3     RDA4    PC1     PC2    PC3
Eigenvalue            0.06963 0.03131 0.01048 0.007551 0.0919 0.04617 0.0260
Proportion Explained  0.19095 0.08585 0.02874 0.020707 0.2520 0.12661 0.0713
Cumulative Proportion 0.19095 0.27680 0.30554 0.326246 0.5782 0.70485 0.7762
                          PC4     PC5    PC6      PC7      PC8      PC9
Eigenvalue            0.01782 0.01444 0.0101 0.009309 0.007841 0.006657
Proportion Explained  0.04886 0.03961 0.0277 0.025527 0.021503 0.018255
Cumulative Proportion 0.82501 0.86462 0.8923 0.917852 0.939355 0.957610
                          PC10     PC11     PC12     PC13      PC14      PC15
Eigenvalue            0.005373 0.003198 0.001731 0.001587 0.0008924 0.0008017
Proportion Explained  0.014735 0.008770 0.004746 0.004353 0.0024471 0.0021985
Cumulative Proportion 0.972345 0.981115 0.985861 0.990214 0.9926608 0.9948593
                           PC16      PC17      PC18      PC19
Eigenvalue            0.0005982 0.0005343 0.0004444 0.0002977
Proportion Explained  0.0016404 0.0014652 0.0012187 0.0008164
Cumulative Proportion 0.9964997 0.9979649 0.9991836 1.0000000

Accumulated constrained eigenvalues
Importance of components:
                         RDA1    RDA2    RDA3     RDA4
Eigenvalue            0.06963 0.03131 0.01048 0.007551
Proportion Explained  0.58529 0.26315 0.08809 0.063469
Cumulative Proportion 0.58529 0.84844 0.93653 1.000000</code></pre>
</div>
</div>
</div><div class="column" style="width:35%;">
<p><span style="font-size: 25px">The output includes:</span></p>
<ul>
<li class="fragment"><p><span style="font-size: 25px">The inertia (<em>i.e.</em> total variance) partitioned into a part explained by the constrained axes, and a residual part (unconstrained).</span></p></li>
<li class="fragment"><p><span style="font-size: 25px">The first axes (RDA1, RDA2, â¦) are the constrained axes, representing the variation explained by the explanatory variables.</span></p></li>
<li class="fragment"><p><span style="font-size: 25px">The remaining axes (PC1, PC2, â¦) are unconstrained and represent the residual variation not explained by the explanatory variables.</span></p></li>
</ul>
</div></div>
<aside class="notes">
<p>not great as not much variation explained by the constrained partâ¦</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="rda---goodness-of-fit" class="slide level2">
<h2>RDA - Goodness of fit</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href=""></a><span class="fu">RsquareAdj</span>(vare_rda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>$r.squared
[1] 0.3262456

$adj.r.squared
[1] 0.1844026</code></pre>
</div>
</div>
<ul>
<li class="fragment"><p><span class="math inline">\(R^2\)</span> is the percentage of variance explained by the constrained part (as shown in the output)</p></li>
<li class="fragment"><p><span class="math inline">\(R^2\)</span> adjusted is corrected to take into account the number of explanatory variables</p></li>
</ul>
<aside class="notes">
<p>as seen, not super good modelâ¦</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="rda---vif" class="slide level2">
<h2>RDA - VIF</h2>
<p>As for a linear regression, we can use the VIF (<em>variance inflation factor</em>) obtained with <span style="color:indianred;">vif.cca</span>, to check that there is not too much collinearity (too much if &gt; 10):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href=""></a><span class="fu">vif.cca</span>(vare_rda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>      pH        N       Mo        P 
1.034667 1.070768 1.062915 1.096808 </code></pre>
</div>
</div>
</section>
<section id="rda---significance-testing" class="slide level2 smaller">
<h2>RDA - Significance testing</h2>
<p><span style="font-size: 30px">The significance of the RDA is obtained with <span style="color:indianred;">anova.cca</span>.</span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="font-size: 30px">Significance of the whole model:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href=""></a><span class="fu">anova.cca</span>(vare_rda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = spec_hel ~ pH + N + Mo + P, data = soil_norm)
         Df Variance   F Pr(&gt;F)   
Model     4  0.11897 2.3  0.004 **
Residual 19  0.24570              
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><span style="font-size: 30px">Significance of each explanatory variable:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href=""></a><span class="fu">anova.cca</span>(vare_rda, <span class="at">by =</span> <span class="st">"term"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for rda under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

Model: rda(formula = spec_hel ~ pH + N + Mo + P, data = soil_norm)
         Df Variance      F Pr(&gt;F)   
pH        1 0.041829 3.2346  0.007 **
N         1 0.023960 1.8528  0.102   
Mo        1 0.018360 1.4198  0.202   
P         1 0.034825 2.6930  0.029 * 
Residual 19 0.245700                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div></div>
</section>
<section id="rda---visualisation" class="slide level2">
<h2>RDA - Visualisation</h2>
<p>RDA is visuallised using a triplot (as it represents the sites, the species and the environmental variables).</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="font-size: 30px">Scaling 1 focusses on the <strong>sites</strong>:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href=""></a><span class="fu">plot</span>(vare_rda, <span class="at">scaling =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-53-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span style="font-size: 30px">Scaling 2 focusses on the <strong>species</strong>:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href=""></a><span class="fu">plot</span>(vare_rda, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="basic_stats_session3_files/figure-revealjs/unnamed-chunk-54-1.png" width="384"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="cca---principle" class="slide level2">
<h2>CCA - Principle</h2>
<p><strong>Canonical Correspondence Analysis</strong> (CCA) is the constrained equivalent of Correspondence Analysis (CA).</p>
<p>It is therefore based on <span class="math inline">\(\chi^2\)</span> distance and assumes <strong>unimodal</strong> relationships between species and environmental variables.</p>
</section>
<section id="cca---running-a-cca" class="slide level2">
<h2>CCA - Running a CCA</h2>
<p><span style="font-size: 30px">We run the CCA with <span style="color:indianred;">cca</span>:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href=""></a>vare_cca <span class="ot">&lt;-</span> <span class="fu">cca</span>(spec_hel <span class="sc">~</span> pH <span class="sc">+</span> N <span class="sc">+</span> Mo <span class="sc">+</span> P,</span>
<span id="cb78-2"><a href=""></a>                <span class="at">data =</span> soil_norm)</span>
<span id="cb78-3"><a href=""></a><span class="fu">summary</span>(vare_cca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
cca(formula = spec_hel ~ pH + N + Mo + P, data = soil_norm) 

Partitioning of scaled Chi-square:
              Inertia Proportion
Total          1.0785     1.0000
Constrained    0.2693     0.2497
Unconstrained  0.8091     0.7503

Eigenvalues, and their contribution to the scaled Chi-square 

Importance of components:
                        CCA1    CCA2    CCA3    CCA4    CA1    CA2     CA3
Eigenvalue            0.1265 0.06809 0.04340 0.03132 0.1696 0.1589 0.09598
Proportion Explained  0.1173 0.06313 0.04024 0.02904 0.1573 0.1474 0.08899
Cumulative Proportion 0.1173 0.18046 0.22070 0.24974 0.4070 0.5544 0.64335
                          CA4     CA5     CA6     CA7     CA8     CA9    CA10
Eigenvalue            0.07226 0.06689 0.05607 0.04324 0.02831 0.02408 0.02256
Proportion Explained  0.06700 0.06202 0.05199 0.04009 0.02625 0.02233 0.02092
Cumulative Proportion 0.71035 0.77238 0.82436 0.86445 0.89071 0.91303 0.93395
                         CA11    CA12    CA13     CA14     CA15     CA16
Eigenvalue            0.01736 0.01156 0.01103 0.008615 0.006007 0.005498
Proportion Explained  0.01609 0.01072 0.01023 0.007988 0.005570 0.005098
Cumulative Proportion 0.95005 0.96077 0.97100 0.978985 0.984555 0.989653
                          CA17     CA18     CA19
Eigenvalue            0.004511 0.003574 0.003073
Proportion Explained  0.004183 0.003314 0.002850
Cumulative Proportion 0.993836 0.997150 1.000000

Accumulated constrained eigenvalues
Importance of components:
                        CCA1    CCA2   CCA3    CCA4
Eigenvalue            0.1265 0.06809 0.0434 0.03132
Proportion Explained  0.4698 0.25280 0.1611 0.11628
Cumulative Proportion 0.4698 0.72258 0.8837 1.00000</code></pre>
</div>
</div>
</section>
<section id="cca---interpretation" class="slide level2">
<h2>CCA - Interpretation</h2>
<p>The rest is similar to the RDA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href=""></a><span class="fu">RsquareAdj</span>(vare_cca)</span>
<span id="cb80-2"><a href=""></a><span class="fu">anova.cca</span>(vare_cca)</span>
<span id="cb80-3"><a href=""></a><span class="fu">anova.cca</span>(vare_cca, <span class="at">by =</span> <span class="st">"term"</span>)</span>
<span id="cb80-4"><a href=""></a><span class="fu">plot</span>(vare_cca, <span class="at">scaling =</span> <span class="dv">1</span>)</span>
<span id="cb80-5"><a href=""></a><span class="fu">plot</span>(vare_cca, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
<aside class="notes">
<p>not ran here, diy</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="db-rda---principle" class="slide level2">
<h2>db-RDA - Principle</h2>
<p><strong>Distance-based Redundancy analysis</strong> (db-RDA) is the constrained equivalent of Principal Coordinate Analysis (PCoA).</p>
<p>It can therefore be used with a variety of distance measures (commonly Bray-Curtis)</p>
</section>
<section id="db-rda---running-db-rda" class="slide level2">
<h2>db-RDA - Running db-RDA</h2>
<p><span style="font-size: 30px">We run the db-RDA with <span style="color:indianred;">dbrda</span>:</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href=""></a>vare_dbrda <span class="ot">&lt;-</span> <span class="fu">dbrda</span>(spec_hel <span class="sc">~</span> pH <span class="sc">+</span> N <span class="sc">+</span> Mo <span class="sc">+</span> P,</span>
<span id="cb81-2"><a href=""></a>                <span class="at">data =</span> soil_norm,</span>
<span id="cb81-3"><a href=""></a>                <span class="at">distance =</span> <span class="st">"bray"</span>)</span>
<span id="cb81-4"><a href=""></a><span class="fu">summary</span>(vare_dbrda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
dbrda(formula = spec_hel ~ pH + N + Mo + P, data = soil_norm,      distance = "bray") 

Partitioning of squared Bray distance:
              Inertia Proportion
Total          2.4141      1.000
Constrained    0.7461      0.309
Unconstrained  1.6680      0.691

Eigenvalues, and their contribution to the squared Bray distance 

Importance of components:
                      dbRDA1  dbRDA2  dbRDA3  dbRDA4   MDS1   MDS2    MDS3
Eigenvalue            0.4372 0.19022 0.07914 0.03950 0.5152 0.3889 0.16885
Proportion Explained  0.1811 0.07879 0.03278 0.01636 0.2134 0.1611 0.06995
Cumulative Proportion 0.1811 0.25990 0.29269 0.30905 0.5225 0.6836 0.75352
                         MDS4    MDS5    MDS6    MDS7    MDS8    MDS9   MDS10
Eigenvalue            0.14887 0.11600 0.10271 0.08099 0.07761 0.04623 0.03680
Proportion Explained  0.06167 0.04805 0.04255 0.03355 0.03215 0.01915 0.01524
Cumulative Proportion 0.81519 0.86325 0.90579 0.93934 0.97149 0.99064 1.00589
                        MDS11    MDS12    MDS13    MDS14     MDS15      iMDS1
Eigenvalue            0.02591 0.015991 0.008064 0.005511 2.337e-04 -0.0023018
Proportion Explained  0.01073 0.006624 0.003340 0.002283 9.682e-05 -0.0009535
Cumulative Proportion 1.01662 1.023246 1.026586 1.028869 1.029e+00  1.0280122
                          iMDS2    iMDS3    iMDS4
Eigenvalue            -0.013127 -0.02573 -0.02877
Proportion Explained  -0.005438 -0.01066 -0.01192
Cumulative Proportion  1.022574  1.01192  1.00000

Accumulated constrained eigenvalues
Importance of components:
                      dbRDA1 dbRDA2  dbRDA3  dbRDA4
Eigenvalue            0.4372 0.1902 0.07914 0.03950
Proportion Explained  0.5860 0.2550 0.10608 0.05294
Cumulative Proportion 0.5860 0.8410 0.94706 1.00000</code></pre>
</div>
</div>
<aside class="notes">
<p>here we didnât do the Lingoes correction so we have negative eigenvalues</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="db-rda---interpretation" class="slide level2">
<h2>db-RDA - Interpretation</h2>
<p>The rest is similar to the RDA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href=""></a><span class="fu">RsquareAdj</span>(vare_dbrda)</span>
<span id="cb83-2"><a href=""></a><span class="fu">anova.cca</span>(vare_dbrda)</span>
<span id="cb83-3"><a href=""></a><span class="fu">anova.cca</span>(vare_dbrda, <span class="at">by =</span> <span class="st">"term"</span>)</span>
<span id="cb83-4"><a href=""></a><span class="fu">plot</span>(vare_dbrda, <span class="at">scaling =</span> <span class="dv">1</span>)</span>
<span id="cb83-5"><a href=""></a><span class="fu">plot</span>(vare_dbrda, <span class="at">scaling =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">

</div>
<aside class="notes">
<p>not ran here, diy</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="acknowledgments" class="slide level2">
<h2>Acknowledgments</h2>
<div>
<ul>
<li><p>Marchand P. <em>Analyses et modÃ©lisation des donnÃ©es Ã©cologiques</em> <a href="https://pmarchand1.github.io/ECL7102/" data-preview-link="false">in French</a></p></li>
<li><p>Marcon E. <em>cours-R-Geeft</em> <a href="https://ericmarcon.github.io/Cours-R-Geeft/" data-preview-link="false">in French</a></p></li>
<li><p>Simpson G. <em>Multivariate data analysis with R and vegan</em> <a href="https://github.com/gavinsimpson/physalia-multivariate?tab=readme-ov-file" data-preview-link="false">here</a></p></li>
<li><p>QCBS R Workshop Series <em>Multivariate Analyses in R</em> <a href="https://r.qcbs.ca/workshop09/book-en/" data-preview-link="false">here</a> and <em>Advanced Multivariate Analyses in R</em> <a href="https://r.qcbs.ca/workshop10/book-en/index.html" data-preview-link="false">here</a></p></li>
</ul>
</div>
</section>
<section id="resources" class="slide level2">
<h2>Resources</h2>
<div>
<ul>
<li><p>Simpson G. <em>Multivariate data analysis with R and vegan</em> <a href="https://gavinsimpson.github.io/physalia-multivariate/02-tuesday/slides.html" data-preview-link="false">here</a> and <a href="https://gavinsimpson.github.io/physalia-multivariate/03-wednesday/slides.html" data-preview-link="false">here</a> (includes some advice on how to customise the plots and extract the results)</p></li>
<li><p>QCBS R Workshop Series <em>Multivariate Analyses in R</em> <a href="https://r.qcbs.ca/workshop09/book-en/" data-preview-link="false">here</a> and <em>Advanced Multivariate Analyses in R</em> <a href="https://r.qcbs.ca/workshop10/book-en/index.html" data-preview-link="false">here</a></p></li>
</ul>
</div>
</section>
<section id="resources-to-go-further" class="slide level2">
<h2>Resources to go further</h2>
<p>Package <a href="https://rdrr.io/github/gavinsimpson/ggvegan/#vignettes" data-preview-link="false">ggvegan</a> to make ggplot style graph from ordination results (not on CRAN)</p>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="basic_stats_session3_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="basic_stats_session3_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="basic_stats_session3_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="basic_stats_session3_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="basic_stats_session3_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="basic_stats_session3_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="basic_stats_session3_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="basic_stats_session3_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="basic_stats_session3_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="basic_stats_session3_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="basic_stats_session3_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
              // target, if specified
              link.setAttribute("target", "_blank");
              if (link.getAttribute("rel") === null) {
                link.setAttribute("rel", "noopener");
              }
              // default icon
              link.classList.add("external");
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>